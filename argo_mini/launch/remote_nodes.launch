<launch>
    <arg name="zed" default="false"/>
    <arg name="mapping" default="false"/>
    <arg name="drive" default="6w"/>

    <machine name="argo_mini" address="192.168.1.18" user="rafpi" password="argo"
             env-loader="/home/rafpi/ws_dzik/env.sh"/>
    <node name="hardware_interface_node" pkg="argo_mini_hardware_interface" type="node" machine="argo_mini"
          required="true">
        <rosparam command="load" file="$(find argo_mini)/config/hardware.yaml"/>
        <param name="argo_mini/drive" value="$(arg drive)"/>
    </node>

    <group>
        <machine name="argo_mini" address="192.168.1.18" user="rafpi" password="argo"
                 env-loader="/home/rafpi/ws_dzik/env.sh" default="true" />
        <include file="$(find freenect_launch)/launch/freenect.launch"/>
    </group>

    <node name="rplidarNode" pkg="rplidar_ros" type="rplidarNode" output="screen"
          machine="argo_mini" launch-prefix="bash -c 'sleep 5.0; $0 $@' ">
        <param name="serial_port"         type="string" value="/dev/ttyUSB0"/>
        <param name="serial_baudrate"     type="int"    value="256000"/><!--A3 -->
        <param name="frame_id"            type="string" value="laser_frame"/>
        <param name="inverted"            type="bool"   value="false"/>
        <param name="angle_compensate"    type="bool"   value="true"/>
        <param name="scan_mode"           type="string" value="Sensitivity"/>
    </node>

    <node pkg="tf" type="static_transform_publisher" name="laser_frame_broadcaster"
          args="0. 0. 0.03 3.14 0. 0.  camera_link laser_frame 500" />

<!--    <node pkg="laser_filters" type="scan_to_scan_filter_chain" name="laser_filter"-->
<!--          machine="argo_mini">-->
<!--        <rosparam command="load" file="$(find argo_mini)/config/laser_filter_config.yaml"/>-->
<!--        <remap from="scan" to="laser/scan"/>-->
<!--        <remap from="scan_filtered" to="laser/scan/filtered"/>-->
<!--    </node>-->

    <include file="$(find argo_mini)/launch/mapping.launch" if="$(arg mapping)">
        <arg name="machine" value="argo_mini"/>
    </include>
</launch>